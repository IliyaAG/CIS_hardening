## metadata for Audit benchmark
benchmark_version: {{ benchmark_version }}

# Set if genuine RHEL (subscription manager check) not for derivatives e.g. CentOS
host_os_distribution: {{ ansible_distribution }}

# timeout for each command to run where set - default = 10seconds/10000ms
timeout_ms: {{ audit_cmd_timeout }}

# Taken from LE rhel8-cis
section1: {{ section1 }}
section2: {{ section2 }}
section3: {{ section3 }}
section4: {{ section4 }}
section5: {{ section5 }}
section6: {{ section6 }}

level_1: {{ level_1 }}
level_2: {{ level_2 }}

selinux_disable: {{ selinux_disable }}

# to enable rules that may have IO impact on a system e.g. full filesystem scans or CPU heavy
run_heavy_tests: {{ audit_run_heavy_tests }}

{% if legacy_boot is defined %}
legacy_boot: {{ legacy_boot }}
{% endif %}

# These variables correspond with the CIS rule IDs or paragraph numbers defined in
# the CIS benchmark documents.
# PLEASE NOTE: These work in coordination with the section # group variables and tags.
# You must enable an entire section in order for the variables below to take effect.
# Section 1 rules
rule_1_1_1_1: {{ rule_1_1_1_1 }}
rule_1_1_1_2: {{ rule_1_1_1_2 }}
rule_1_1_1_3: {{ rule_1_1_1_3 }}
rule_1_1_1_4: {{ rule_1_1_1_4 }}
rule_1_1_1_5: {{ rule_1_1_1_5 }}
rule_1_1_1_6: {{ rule_1_1_1_6 }}
rule_1_1_1_7: {{ rule_1_1_1_7 }}
rule_1_1_1_8: {{ rule_1_1_1_8 }}
# /tmp
rule_1_1_2_1_1: {{ rule_1_1_2_1_1 }}
rule_1_1_2_1_2: {{ rule_1_1_2_1_2 }}
rule_1_1_2_1_3: {{ rule_1_1_2_1_3 }}
rule_1_1_2_1_4: {{ rule_1_1_2_1_4 }}

# /dev/shm
rule_1_1_2_2_1: {{ rule_1_1_2_2_1 }}
rule_1_1_2_2_2: {{ rule_1_1_2_2_2 }}
rule_1_1_2_2_3: {{ rule_1_1_2_2_3 }}
rule_1_1_2_2_4: {{ rule_1_1_2_2_4 }}

# /home
rule_1_1_2_3_1: {{ rule_1_1_2_3_1 }}
rule_1_1_2_3_2: {{ rule_1_1_2_3_2 }}
rule_1_1_2_3_3: {{ rule_1_1_2_3_3 }}

# /var
rule_1_1_2_4_1: {{ rule_1_1_2_4_1 }}
rule_1_1_2_4_2: {{ rule_1_1_2_4_2 }}
rule_1_1_2_4_3: {{ rule_1_1_2_4_3 }}

# /var/tmp
rule_1_1_2_5_1: {{ rule_1_1_2_5_1 }}
rule_1_1_2_5_2: {{ rule_1_1_2_5_2 }}
rule_1_1_2_5_3: {{ rule_1_1_2_5_3 }}
rule_1_1_2_5_4: {{ rule_1_1_2_5_4 }}

# /var/log
rule_1_1_2_6_1: {{ rule_1_1_2_6_1 }}
rule_1_1_2_6_2: {{ rule_1_1_2_6_2 }}
rule_1_1_2_6_3: {{ rule_1_1_2_6_3 }}
rule_1_1_2_6_4: {{ rule_1_1_2_6_4 }}

# /var/log/audit
rule_1_1_2_7_1: {{ rule_1_1_2_7_1 }}
rule_1_1_2_7_2: {{ rule_1_1_2_7_2 }}
rule_1_1_2_7_3: {{ rule_1_1_2_7_3 }}
rule_1_1_2_7_4: {{ rule_1_1_2_7_4 }}

# DNF - Patching
rule_1_2_1: {{ rule_1_2_1 }}
rule_1_2_2: {{ rule_1_2_2 }}
rule_1_2_3: {{ rule_1_2_3 }}
rule_1_2_4: {{ rule_1_2_4 }}
rule_1_2_5: {{ rule_1_2_5 }}

# bootloader grub
rule_1_3_1: {{ rule_1_3_1 }}
rule_1_3_2: {{ rule_1_3_2 }}

# kernel sysctl and coredumps
rule_1_4_1: {{ rule_1_4_1 }}
rule_1_4_2: {{ rule_1_4_2 }}
rule_1_4_3: {{ rule_1_4_3 }}
rule_1_4_4: {{ rule_1_4_4 }}

# SElinux
rule_1_5_1_1: {{ rule_1_5_1_1 }}
rule_1_5_1_2: {{ rule_1_5_1_2 }}
rule_1_5_1_3: {{ rule_1_5_1_3 }}
rule_1_5_1_4: {{ rule_1_5_1_4 }}
rule_1_5_1_5: {{ rule_1_5_1_5 }}
rule_1_5_1_6: {{ rule_1_5_1_6 }}
rule_1_5_1_7: {{ rule_1_5_1_7 }}
rule_1_5_1_8: {{ rule_1_5_1_8 }}

# Crypto Policies
rule_1_6_1: {{ rule_1_6_1 }}
rule_1_6_2: {{ rule_1_6_2 }}
rule_1_6_3: {{ rule_1_6_3 }}
rule_1_6_4: {{ rule_1_6_4 }}

# MOTD and messages
rule_1_7_1: {{ rule_1_7_1 }}
rule_1_7_2: {{ rule_1_7_2 }}
rule_1_7_3: {{ rule_1_7_3 }}
rule_1_7_4: {{ rule_1_7_4 }}
rule_1_7_5: {{ rule_1_7_5 }}
rule_1_7_6: {{ rule_1_7_6 }}

# Gnome desktop
rule_1_8_1: {{ rule_1_8_1 }}
rule_1_8_2: {{ rule_1_8_2 }}
rule_1_8_3: {{ rule_1_8_3 }}
rule_1_8_4: {{ rule_1_8_4 }}
rule_1_8_5: {{ rule_1_8_5 }}
rule_1_8_6: {{ rule_1_8_6 }}
rule_1_8_7: {{ rule_1_8_7 }}
rule_1_8_8: {{ rule_1_8_8 }}
rule_1_8_9: {{ rule_1_8_9 }}
rule_1_8_10: {{ rule_1_8_10 }}

# Section 2 rules
# time sync
rule_2_1_1: {{ rule_2_1_1 }}
rule_2_1_2: {{ rule_2_1_2 }}
rule_2_1_3: {{ rule_2_1_3 }}

# Server services
rule_2_2_1: {{ rule_2_2_1 }}
rule_2_2_2: {{ rule_2_2_2 }}
rule_2_2_3: {{ rule_2_2_3 }}
rule_2_2_4: {{ rule_2_2_4 }}
rule_2_2_5: {{ rule_2_2_5 }}
rule_2_2_6: {{ rule_2_2_6 }}
rule_2_2_7: {{ rule_2_2_7 }}
rule_2_2_8: {{ rule_2_2_8 }}
rule_2_2_9: {{ rule_2_2_9 }}
rule_2_2_10: {{ rule_2_2_10 }}
rule_2_2_11: {{ rule_2_2_11 }}
rule_2_2_12: {{ rule_2_2_12 }}
rule_2_2_13: {{ rule_2_2_13 }}
rule_2_2_14: {{ rule_2_2_14 }}
rule_2_2_15: {{ rule_2_2_15 }}
rule_2_2_16: {{ rule_2_2_16 }}
rule_2_2_17: {{ rule_2_2_17 }}
rule_2_2_18: {{ rule_2_2_18 }}
rule_2_2_19: {{ rule_2_2_19 }}
rule_2_2_20: {{ rule_2_2_20 }}
rule_2_2_21: {{ rule_2_2_21 }}
rule_2_2_22: {{ rule_2_2_22 }}

# Client services
rule_2_3_1: {{ rule_2_3_1 }}
rule_2_3_2: {{ rule_2_3_2 }}
rule_2_3_3: {{ rule_2_3_3 }}
rule_2_3_4: {{ rule_2_3_4 }}
rule_2_3_5: {{ rule_2_3_5 }}

# Section 3 rules
# network connectivity wifi/bluetooth/ipv6
rule_3_1_1: {{ rule_3_1_1 }}
rule_3_1_2: {{ rule_3_1_2 }}
rule_3_1_3: {{ rule_3_1_3 }}

# Network Kernel module
rule_3_2_1: {{ rule_3_2_1 }}
rule_3_2_2: {{ rule_3_2_2 }}
rule_3_2_3: {{ rule_3_2_3 }}
rule_3_2_4: {{ rule_3_2_4 }}

# Network Kernel Params
rule_3_3_1: {{ rule_3_3_1 }}
rule_3_3_2: {{ rule_3_3_2 }}
rule_3_3_3: {{ rule_3_3_3 }}
rule_3_3_4: {{ rule_3_3_4 }}
rule_3_3_5: {{ rule_3_3_5 }}
rule_3_3_6: {{ rule_3_3_6 }}
rule_3_3_7: {{ rule_3_3_7 }}
rule_3_3_8: {{ rule_3_3_8 }}
rule_3_3_9: {{ rule_3_3_9 }}
rule_3_3_10: {{ rule_3_3_10 }}
rule_3_3_11: {{ rule_3_3_11 }}

# Firewall
rule_3_4_1_1: {{ rule_3_4_1_1 }}
rule_3_4_1_2: {{ rule_3_4_1_2 }}

# Firewall rules
rule_3_4_2_1: {{ rule_3_4_2_1 }}
rule_3_4_2_2: {{ rule_3_4_2_2 }}
rule_3_4_2_3: {{ rule_3_4_2_3 }}
rule_3_4_2_4: {{ rule_3_4_2_4 }}
rule_3_4_2_5: {{ rule_3_4_2_5 }}

##
## Section 4 rules
##
# cron
rule_4_1_1_1: {{ rule_4_1_1_1 }}
rule_4_1_1_2: {{ rule_4_1_1_2 }}
rule_4_1_1_3: {{ rule_4_1_1_3 }}
rule_4_1_1_4: {{ rule_4_1_1_4 }}
rule_4_1_1_5: {{ rule_4_1_1_5 }}
rule_4_1_1_6: {{ rule_4_1_1_6 }}
rule_4_1_1_7: {{ rule_4_1_1_7 }}
rule_4_1_1_8: {{ rule_4_1_1_8 }}

# at
rule_4_1_2_1: {{ rule_4_1_2_1 }}

# sshd
rule_4_2_1: {{ rule_4_2_1 }}
rule_4_2_2: {{ rule_4_2_2 }}
rule_4_2_3: {{ rule_4_2_3 }}
rule_4_2_4: {{ rule_4_2_4 }}
rule_4_2_5: {{ rule_4_2_5 }}
rule_4_2_6: {{ rule_4_2_6 }}
rule_4_2_7: {{ rule_4_2_7 }}
rule_4_2_8: {{ rule_4_2_8 }}
rule_4_2_9: {{ rule_4_2_9 }}
rule_4_2_10: {{ rule_4_2_10 }}
rule_4_2_12: {{ rule_4_2_12 }}
rule_4_2_11: {{ rule_4_2_11 }}
rule_4_2_13: {{ rule_4_2_13 }}
rule_4_2_14: {{ rule_4_2_14 }}
rule_4_2_15: {{ rule_4_2_15 }}
rule_4_2_16: {{ rule_4_2_16 }}
rule_4_2_17: {{ rule_4_2_17 }}
rule_4_2_18: {{ rule_4_2_18 }}
rule_4_2_19: {{ rule_4_2_19 }}
rule_4_2_20: {{ rule_4_2_20 }}
rule_4_2_21: {{ rule_4_2_21 }}
rule_4_2_22: {{ rule_4_2_22 }}

# sudo
rule_4_3_1: {{ rule_4_3_1 }}
rule_4_3_2: {{ rule_4_3_2 }}
rule_4_3_3: {{ rule_4_3_3 }}
rule_4_3_4: {{ rule_4_3_4 }}
rule_4_3_5: {{ rule_4_3_5 }}
rule_4_3_6: {{ rule_4_3_6 }}
rule_4_3_7: {{ rule_4_3_7 }}

# Pam software pkgs
rule_4_4_1_1: {{ rule_4_4_1_1 }}
rule_4_4_1_2: {{ rule_4_4_1_2 }}

# authselect
rule_4_4_2_1: {{ rule_4_4_2_1 }}
rule_4_4_2_2: {{ rule_4_4_2_2 }}
rule_4_4_2_3: {{ rule_4_4_2_3 }}
rule_4_4_2_4: {{ rule_4_4_2_4 }}
rule_4_4_2_5: {{ rule_4_4_2_5 }}

# pam faillock
rule_4_4_3_1_1: {{ rule_4_4_3_1_1 }}
rule_4_4_3_1_2: {{ rule_4_4_3_1_2 }}
rule_4_4_3_1_3: {{ rule_4_4_3_1_3 }}

# pam pwquality
rule_4_4_3_2_1: {{ rule_4_4_3_2_1 }}
rule_4_4_3_2_2: {{ rule_4_4_3_2_2 }}
rule_4_4_3_2_3: {{ rule_4_4_3_2_3 }}
rule_4_4_3_2_4: {{ rule_4_4_3_2_4 }}
rule_4_4_3_2_5: {{ rule_4_4_3_2_5 }}
rule_4_4_3_2_6: {{ rule_4_4_3_2_6 }}
rule_4_4_3_2_7: {{ rule_4_4_3_2_7 }}

# pam pwhistory
rule_4_4_3_3_1: {{ rule_4_4_3_3_1 }}
rule_4_4_3_3_2: {{ rule_4_4_3_3_2 }}
rule_4_4_3_3_3: {{ rule_4_4_3_3_3 }}

# pam pam_unix
rule_4_4_3_4_1: {{ rule_4_4_3_4_1 }}
rule_4_4_3_4_2: {{ rule_4_4_3_4_2 }}
rule_4_4_3_4_3: {{ rule_4_4_3_4_3 }}
rule_4_4_3_4_4: {{ rule_4_4_3_4_4 }}

# Shadow user settings
rule_4_5_1_1: {{ rule_4_5_1_1 }}
rule_4_5_1_2: {{ rule_4_5_1_2 }}
rule_4_5_1_3: {{ rule_4_5_1_3 }}
rule_4_5_1_4: {{ rule_4_5_1_4 }}
rule_4_5_1_5: {{ rule_4_5_1_5 }}

# root and sys accts and env
rule_4_5_2_1: {{ rule_4_5_2_1 }}
rule_4_5_2_2: {{ rule_4_5_2_2 }}
rule_4_5_2_3: {{ rule_4_5_2_3 }}
rule_4_5_2_4: {{ rule_4_5_2_4 }}
rule_4_5_2_5: {{ rule_4_5_2_5 }}

# User environment
rule_4_5_3_1: {{ rule_4_5_3_1 }}
rule_4_5_3_2: {{ rule_4_5_3_2 }}
rule_4_5_3_3: {{ rule_4_5_3_3 }}

##
## Section 5 rules
##

# Rsyslog
rule_5_1_1_1: {{ rule_5_1_1_1 }}
rule_5_1_1_2: {{ rule_5_1_1_2 }}
rule_5_1_1_3: {{ rule_5_1_1_3 }}
rule_5_1_1_4: {{ rule_5_1_1_4 }}
rule_5_1_1_5: {{ rule_5_1_1_5 }}
rule_5_1_1_6: {{ rule_5_1_1_6 }}
rule_5_1_1_7: {{ rule_5_1_1_7 }}

# Journald
rule_5_1_2_1_1: {{ rule_5_1_2_1_1 }}
rule_5_1_2_1_2: {{ rule_5_1_2_1_2 }}
rule_5_1_2_1_3: {{ rule_5_1_2_1_3 }}
rule_5_1_2_1_4: {{ rule_5_1_2_1_4 }}
rule_5_1_2_2: {{ rule_5_1_2_2 }}
rule_5_1_2_3: {{ rule_5_1_2_3 }}
rule_5_1_2_4: {{ rule_5_1_2_4 }}
rule_5_1_2_5: {{ rule_5_1_2_5 }}
rule_5_1_2_6: {{ rule_5_1_2_6 }}
rule_5_1_3: {{ rule_5_1_3 }}
rule_5_1_4: {{ rule_5_1_4 }}

# Auditd
rule_5_2_1_1: {{ rule_5_2_1_1 }}
rule_5_2_1_2: {{ rule_5_2_1_2 }}
rule_5_2_1_3: {{ rule_5_2_1_3 }}
rule_5_2_1_4: {{ rule_5_2_1_4 }}
rule_5_2_2_1: {{ rule_5_2_2_1 }}
rule_5_2_2_2: {{ rule_5_2_2_2 }}
rule_5_2_2_3: {{ rule_5_2_2_3 }}
rule_5_2_2_4: {{ rule_5_2_2_4 }}

# auditd rules
rule_5_2_3_1: {{ rule_5_2_3_1 }}
rule_5_2_3_2: {{ rule_5_2_3_2 }}
rule_5_2_3_3: {{ rule_5_2_3_3 }}
rule_5_2_3_4: {{ rule_5_2_3_4 }}
rule_5_2_3_5: {{ rule_5_2_3_5 }}
rule_5_2_3_6: {{ rule_5_2_3_6 }}
rule_5_2_3_7: {{ rule_5_2_3_7 }}
rule_5_2_3_8: {{ rule_5_2_3_8 }}
rule_5_2_3_9: {{ rule_5_2_3_9 }}
rule_5_2_3_10: {{ rule_5_2_3_10 }}
rule_5_2_3_11: {{ rule_5_2_3_11 }}
rule_5_2_3_12: {{ rule_5_2_3_12 }}
rule_5_2_3_13: {{ rule_5_2_3_13 }}
rule_5_2_3_14: {{ rule_5_2_3_14 }}
rule_5_2_3_15: {{ rule_5_2_3_15 }}
rule_5_2_3_16: {{ rule_5_2_3_16 }}
rule_5_2_3_17: {{ rule_5_2_3_17 }}
rule_5_2_3_18: {{ rule_5_2_3_18 }}
rule_5_2_3_19: {{ rule_5_2_3_19 }}
rule_5_2_3_20: {{ rule_5_2_3_20 }}
rule_5_2_3_21: {{ rule_5_2_3_21 }}

# auditd log perms
rule_5_2_4_1: {{ rule_5_2_4_1 }}
rule_5_2_4_2: {{ rule_5_2_4_2 }}
rule_5_2_4_3: {{ rule_5_2_4_3 }}
rule_5_2_4_4: {{ rule_5_2_4_4 }}
rule_5_2_4_5: {{ rule_5_2_4_5 }}
rule_5_2_4_6: {{ rule_5_2_4_6 }}
rule_5_2_4_7: {{ rule_5_2_4_7 }}
rule_5_2_4_8: {{ rule_5_2_4_8 }}
rule_5_2_4_9: {{ rule_5_2_4_9 }}
rule_5_2_4_10: {{ rule_5_2_4_10 }}

# AIDE

rule_5_3_1: {{ rule_5_3_1 }}
rule_5_3_2: {{ rule_5_3_2 }}
rule_5_3_3: {{ rule_5_3_3 }}

##
## Section 6 rules
##

# System file perms
rule_6_1_1: {{ rule_6_1_1 }}
rule_6_1_2: {{ rule_6_1_2 }}
rule_6_1_3: {{ rule_6_1_3 }}
rule_6_1_4: {{ rule_6_1_4 }}
rule_6_1_5: {{ rule_6_1_5 }}
rule_6_1_6: {{ rule_6_1_6 }}
rule_6_1_7: {{ rule_6_1_7 }}
rule_6_1_8: {{ rule_6_1_8 }}
rule_6_1_9: {{ rule_6_1_9 }}
rule_6_1_10: {{ rule_6_1_10 }}
rule_6_1_11: {{ rule_6_1_11 }}
rule_6_1_12: {{ rule_6_1_12 }}
rule_6_1_13: {{ rule_6_1_13 }}
rule_6_1_14: {{ rule_6_1_14 }}

# local and usergroup
rule_6_2_1: {{ rule_6_2_1 }}
rule_6_2_2: {{ rule_6_2_2 }}
rule_6_2_3: {{ rule_6_2_3 }}
rule_6_2_4: {{ rule_6_2_4 }}
rule_6_2_5: {{ rule_6_2_5 }}
rule_6_2_6: {{ rule_6_2_6 }}
rule_6_2_7: {{ rule_6_2_7 }}
rule_6_2_8: {{ rule_6_2_8 }}
rule_6_2_9: {{ rule_6_2_9 }}
rule_6_2_10: {{ rule_6_2_10 }}
rule_6_2_11: {{ rule_6_2_11 }}

##
## Section 1 vars
##
# 1.1.2.2
# 1.1.2.3
# 1.1.2.4
# These settings go into the /etc/fstab file for the /tmp mount settings
# The value must contain nosuid,nodev,noexec to conform to CIS standards
# tmp_tmpfs_settings: "defaults,rw,nosuid,nodev,noexec,relatime 0 0"
# If set true uses the tmp.mount service else using fstab configuration
tmp_svc: {{ tmp_svc }}

# 1.2 patch system
apply_installed_kernel_limit: {{ apply_installed_kernel_limit }}
installed_kernel_limit: {{ installed_kernel_limit }}

# 1.3 Bootloader password
bootloader_password_hash: {{ bootloader_password_hash }}
bootloader_password: {{ bootloader_password }}
set_boot_pass: {{ set_boot_pass }}
boot_path: {{ boot_path }}

# 1.5 SELinux policy
selinux_pol: {{ selinux_policy }}

# 1.6 Set crypto policy (LEGACY, DEFAULT, FUTURE, FIPS)
crypto_policy: {{ crypto_policy }}
# Added module to be allowed as default setting (Allowed options in vars/main.yml)
crypto_policy_module: {{ crypto_policy_module }}

# 1.7
# Warning Banner Content (issue, issue.net, motd)
warning_banner: {{ warning_banner }}
# End Banner

# 1.8 Gnome Desktop
# Whether or not to run tasks related to auditing/patching the desktop environment
gui: {{ gui }}
dconf_db_name: {{ dconf_db_name }}
screensaver_idle_delay: {{ screensaver_idle_delay }}  # Set max value for idle-delay in seconds (between 1 and 900)
screensaver_lock_delay: {{ screensaver_lock_delay }}  # Set max value for lock-delay in seconds (between 0 and 5)
##
## Section 2 vars
##
# 2.1.1 Time Synchronization - Either chrony or ntp
time_synchronization: {{ time_synchronization }}

# Time Synchronization servers - used in template file chrony.conf.j2
time_synchronization_servers:
{% for server in time_synchronization_servers %}
    - {{ server }}
{% endfor %}

chrony_server_options: "{{ chrony_server_options }}"
ntp_server_options: "{{ ntp_server_options }}"

# Service configuration
# Options are
# true to leave installed if exists not changes take place
# false - this removes the package
# mask - if a dependency for product so cannot be removed
# Server Services
autofs_services: {{ autofs_services }}
autofs_mask: {{ autofs_mask }}
avahi_server: {{ avahi_server }}
avahi_mask: {{ avahi_mask }}
dhcp_server: {{ dhcp_server }}
dhcp_mask: {{ dhcp_mask }}
dns_server: {{ dns_server }}
dns_mask: {{ dns_mask }}
dnsmasq_server: {{ dnsmasq_server }}
dnsmasq_mask: {{ dnsmasq_mask }}
samba_server: {{ samba_server }}
samba_mask: {{ samba_mask }}
ftp_server: {{ ftp_server }}
ftp_mask: {{ ftp_mask }}
message_server: {{ message_server }}  # This is for messaging dovecot and cyrus-imap
message_mask: {{ message_mask }}
nfs_server: {{ nfs_server }}
nfs_mask: {{ nfs_mask }}
nis_server: {{ nis_server }}  # set to mask if nis client required
nis_mask: {{ nis_mask }}
print_server: {{ print_server }}  # replaces cups
print_mask: {{ print_mask }}
rpc_server: {{ rpc_server }}
rpc_mask: {{ rpc_mask }}
rsync_server: {{ rsync_server }}
rsync_mask: {{ rsync_mask }}
net_snmp_server: {{ net_snmp_server }}
net_snmp_mask: {{ net_snmp_mask }}
telnet_server: {{ telnet_server }}
telnet_mask: {{ telnet_mask }}
tftp_server: {{ tftp_server }}
tftp_mask: {{ tftp_mask }}
squid_server: {{ squid_server }}
squid_mask: {{ squid_mask }}
httpd_server: {{ httpd_server }}
httpd_mask: {{ httpd_mask }}
nginx_server: {{ nginx_server }}
nginx_mask: {{ nginx_mask }}
xinetd_server: {{ xinetd_server }}
xinetd_mask: {{ xinetd_mask }}
xwindow_server: {{ xwindow_server }}  # will remove mask not an option
is_mail_server: {{ is_mail_server }}

# Client Services
ftp_client: {{ ftp_client }}
openldap_clients_required: {{ openldap_clients_required }}
ypbind_required: {{ ypbind_required }}  # Same package as NIS server
telnet_required: {{ telnet_required }}
tftp_client: {{ tftp_client }}

##
## Section 3 vars
##

bluetooth_service: {{ bluetooth_service }}
bluetooth_mask: {{ bluetooth_mask }}

# System network parameters (host only OR host and router)
is_router: {{ is_router }}

# IPv6 required
ipv6_required: {{ ipv6_required }}

ipv6_sysctl_force: {{ ipv6_sysctl_force }}

##  Optional - Understand the impact of making the following two control to true
# By default, we do not disable IPv6 on localhost, as it's important for multiple
# components.  If you want to disable it anyway, change the following
# value to true refer https://access.redhat.com/solutions/8709
# this changes sysctl and /etc/hosts
# requires reboot
ipv6_disable_localhost: {{ ipv6_disable_localhost }}
# disable ipv6 for sshd
ipv6_sshd_disable: {{ ipv6_sshd_disable }}
# disable chrony on ipv6
ipv6_chrony_disable: {{ ipv6_chrony_disable }}

# Set to 'true' if X Windows is needed in your environment
xwindows_required: {{ xwindows_required }}

## Section3 vars

# default location for the sysctl overrides.
sysctl_file: {{ sysctl_file }}

# Firewall Service - either firewalld or nftables
firewall: {{ firewall }}

default_zone: {{ default_zone }}

nft_tables_autonewtable: {{ nft_tables_autonewtable }}
nft_tables_tablename: {{ nft_tables_tablename }}

# 3.4.2.6 Set nftables new chain create
nft_tables_autochaincreate: {{ nft_tables_autochaincreate }}

#######
## Section4 vars
######
## If using the allow/deny user groups options
sshd_limited: {{ sshd_limited }}
sshd:
    clientalivecountmax: {{ sshd_clientalivecountmax }}
    clientaliveinterval: {{ sshd_clientaliveinterval }}
    logingracetime: {{ sshd_logingracetime }}
    loglevel: {{ sshd_loglevel }}
    macs: '{{ sshd_macs }}'
    maxauthtries: {{ sshd_maxauthtries }}
    maxsessions: {{ sshd_maxsessions }}
    maxstartups: '{{ sshd_maxstartups }}'
    ciphers: '{{ sshd_ciphers }}'
    kex: '{{ sshd_kex }}'
{% if sshd_limited %}
    # WARNING: make sure you understand the precedence when working with these values!!
    {% if sshd_allowusers is defined %}
    # allowusers: '{{ sshd_allowusers }}'
    {% endif %}
    {% if sshd_allowgroups is defined %}
    # allowgroups: '{{ sshd_allowgroups }}'
    {% endif %}
    {% if sshd_denyusers is defined %}
    # denyusers: '{{ sshd.denyusers }}'
    {% endif %}
    {% if sshd_denygroups is defined %}
    # denygroups: '{{ sshd_denygroups }}'
    {% endif %}
{% endif %}

# 4.3. sudo
sudolog_location: "{{ sudolog_location }}"
sudo_timestamp_timeout: {{ sudo_timestamp_timeout }}

## PAM
# 4.4.2.x
allow_authselect_updates: {{ allow_authselect_updates }}
authselect_custom_profile_name: '{{ authselect_custom_profile_name }}'

pam_faillock:
    attempts: {{ pam_faillock_attempts }}
    deny: {{ pam_faillock_deny }}
    interval: {{ pam_faillock_interval }}
    unlock_time: {{ pam_faillock_unlock_time }}
    root_unlock_time: {{ pam_faillock_root_unlock_time }}
    # Choose options below for root options
    root_option: {{ pam_faillock_root_option }}

pam_pwquality:
    difok: {{ pam_pwquality_difok }}
    maxrepeat: {{ pam_pwquality_maxrepeat }}
    maxseq: {{ pam_pwquality_maxseq }}
    minlen: {{ pam_pwquality_minlen }}
    minclass: {{ pam_pwquality_minclass }}

pam_pwhistory:
    remember: {{ pam_pwhistory_remember }}

pam_pwhash: {{ pam_pwhash }}

pass:
    inactive: {{ pam_pass_inactive }}
    max_days: {{ pam_pass_max_days }}
    min_days: {{ pam_pass_min_days }}
    warn_age: {{ pam_pass_warn_age }}

root_umask: {{ root_umask }}  # 0027 or more restrictive

shell_session_timeout:
    file: {{ shell_session_file }}
    timeout: {{ shell_session_timeout }}

# 5.3.7
sugroup: {{ sugroup }}

# wheel users list
sugroup_users: "{{ sugroup_users }}"

inactivelock:
    lock_days: {{ inactivelock.lock_days }}

# 5.6.1.5 Allow ansible to expire password for account with a last changed date in the future. False will just display users in violation, true will expire those users passwords
futurepwchgdate_autofix: {{ futurepwchgdate_autofix }}

## Section5 vars

## Preferred method of logging
## Whether rsyslog or journald preferred method for local logging
syslog: {{ syslog }}
rsyslog_ansiblemanaged: {{ rsyslog_ansiblemanaged }}
# Set if system is the log server
system_is_log_server: {{ system_is_log_server }}

#### remote and destination log server name
remote_log_server: {{ remote_log_server }}
remote_log_host: {{ remote_log_host }}
remote_log_port: {{ remote_log_port }}
remote_log_protocol: {{ remote_log_protocol }}
remote_log_retrycount: {{ remote_log_retrycount }}
remote_log_queuesize: {{ remote_log_queuesize }}

update_audit_template: {{ update_audit_template }}

auditd:
    disk_error_action: {{ auditd_disk_error_action }}
    disk_full_action: {{ auditd_disk_full_action }}
    action_mail_acct: {{ auditd_action_mail_acct }}
    space_left_action: {{ auditd_space_left_action }}
    admin_space_left_action: {{ auditd_admin_space_left_action }}
    max_log_file_action: {{ auditd_max_log_file_action }}

logrotate: {{ logrotate }}

## Journald
# journal_upload_url is the ip address to upload the journal entries to
journal_upload_url: {{ journal_upload_url }}
# The paths below have the default paths/files, but allow user to create custom paths/filenames
journal_upload_serverkeyfile: {{ journal_upload_serverkeyfile }}
journal_servercertificatefile: {{ journal_servercertificatefile }}
journal_trustedcertificatefile: {{ journal_trustedcertificatefile }}

# The variables below related to journald, please set these to your site specific values
# journald_systemmaxuse is the max amount of disk space the logs will use
journald_systemmaxuse: {{ journald_systemmaxuse }}
# journald_systemkeepfree is the amount of disk space to keep free
journald_systemkeepfree: {{ journald_systemkeepfree }}
journald_runtimemaxuse: {{ journald_runtimemaxuse }}
journald_runtimekeepfree: {{ journald_runtimekeepfree }}
# journald_MaxFileSec is how long in time to keep log files. Values are Xm, Xh, Xday, Xweek, Xmonth, Xyear, for example 2week is two weeks
journald_maxfilesec: {{ journald_maxfilesec }}

# logrotate configuration
# change to true if you wish to change logrotate.d conf files
allow_logrotate_conf_umask_updates: {{ allow_logrotate_conf_umask_updates }}

## AIDE
aide_scan: {{ aide_scan }}
config_aide: {{ config_aide }}
# AIDE cron settings
aide_cron:
    cron_user: '{{ aide_cron_user }}'
    cron_file: '{{ aide_cron_file }}'
    aide_job: '{{ aide_cron_job }}'
    aide_minute: '{{ aide_cron_minute }}'
    aide_hour: '{{ aide_cron_hour }}'
    aide_day: '{{ aide_cron_day }}'
    aide_month: '{{ aide_cron_month }}'
    aide_weekday: '{{ aide_cron_weekday }}'

## Section6 vars## metadata for Audit benchmark
benchmark_version: {{ benchmark_version }}

# Set if genuine RHEL (subscription manager check) not for derivatives e.g. CentOS
host_os_distribution: {{ ansible_distribution }}

# timeout for each command to run where set - default = 10seconds/10000ms
timeout_ms: {{ audit_cmd_timeout }}

# Taken from LE rhel8-cis
section1: {{ section1 }}
section2: {{ section2 }}
section3: {{ section3 }}
section4: {{ section4 }}
section5: {{ section5 }}
section6: {{ section6 }}

level_1: {{ level_1 }}
level_2: {{ level_2 }}

selinux_disable: {{ selinux_disable }}

# to enable rules that may have IO impact on a system e.g. full filesystem scans or CPU heavy
run_heavy_tests: {{ audit_run_heavy_tests }}

{% if legacy_boot is defined %}
legacy_boot: {{ legacy_boot }}
{% endif %}

# These variables correspond with the CIS rule IDs or paragraph numbers defined in
# the CIS benchmark documents.
# PLEASE NOTE: These work in coordination with the section # group variables and tags.
# You must enable an entire section in order for the variables below to take effect.
# Section 1 rules
rule_1_1_1_1: {{ rule_1_1_1_1 }}
rule_1_1_1_2: {{ rule_1_1_1_2 }}
rule_1_1_1_3: {{ rule_1_1_1_3 }}
rule_1_1_1_4: {{ rule_1_1_1_4 }}
rule_1_1_1_5: {{ rule_1_1_1_5 }}
rule_1_1_1_6: {{ rule_1_1_1_6 }}
rule_1_1_1_7: {{ rule_1_1_1_7 }}
rule_1_1_1_8: {{ rule_1_1_1_8 }}
# /tmp
rule_1_1_2_1_1: {{ rule_1_1_2_1_1 }}
rule_1_1_2_1_2: {{ rule_1_1_2_1_2 }}
rule_1_1_2_1_3: {{ rule_1_1_2_1_3 }}
rule_1_1_2_1_4: {{ rule_1_1_2_1_4 }}

# /dev/shm
rule_1_1_2_2_1: {{ rule_1_1_2_2_1 }}
rule_1_1_2_2_2: {{ rule_1_1_2_2_2 }}
rule_1_1_2_2_3: {{ rule_1_1_2_2_3 }}
rule_1_1_2_2_4: {{ rule_1_1_2_2_4 }}

# /home
rule_1_1_2_3_1: {{ rule_1_1_2_3_1 }}
rule_1_1_2_3_2: {{ rule_1_1_2_3_2 }}
rule_1_1_2_3_3: {{ rule_1_1_2_3_3 }}

# /var
rule_1_1_2_4_1: {{ rule_1_1_2_4_1 }}
rule_1_1_2_4_2: {{ rule_1_1_2_4_2 }}
rule_1_1_2_4_3: {{ rule_1_1_2_4_3 }}

# /var/tmp
rule_1_1_2_5_1: {{ rule_1_1_2_5_1 }}
rule_1_1_2_5_2: {{ rule_1_1_2_5_2 }}
rule_1_1_2_5_3: {{ rule_1_1_2_5_3 }}
rule_1_1_2_5_4: {{ rule_1_1_2_5_4 }}

# /var/log
rule_1_1_2_6_1: {{ rule_1_1_2_6_1 }}
rule_1_1_2_6_2: {{ rule_1_1_2_6_2 }}
rule_1_1_2_6_3: {{ rule_1_1_2_6_3 }}
rule_1_1_2_6_4: {{ rule_1_1_2_6_4 }}

# /var/log/audit
rule_1_1_2_7_1: {{ rule_1_1_2_7_1 }}
rule_1_1_2_7_2: {{ rule_1_1_2_7_2 }}
rule_1_1_2_7_3: {{ rule_1_1_2_7_3 }}
rule_1_1_2_7_4: {{ rule_1_1_2_7_4 }}

# DNF - Patching
rule_1_2_1: {{ rule_1_2_1 }}
rule_1_2_2: {{ rule_1_2_2 }}
rule_1_2_3: {{ rule_1_2_3 }}
rule_1_2_4: {{ rule_1_2_4 }}
rule_1_2_5: {{ rule_1_2_5 }}

# bootloader grub
rule_1_3_1: {{ rule_1_3_1 }}
rule_1_3_2: {{ rule_1_3_2 }}

# kernel sysctl and coredumps
rule_1_4_1: {{ rule_1_4_1 }}
rule_1_4_2: {{ rule_1_4_2 }}
rule_1_4_3: {{ rule_1_4_3 }}
rule_1_4_4: {{ rule_1_4_4 }}

# SElinux
rule_1_5_1_1: {{ rule_1_5_1_1 }}
rule_1_5_1_2: {{ rule_1_5_1_2 }}
rule_1_5_1_3: {{ rule_1_5_1_3 }}
rule_1_5_1_4: {{ rule_1_5_1_4 }}
rule_1_5_1_5: {{ rule_1_5_1_5 }}
rule_1_5_1_6: {{ rule_1_5_1_6 }}
rule_1_5_1_7: {{ rule_1_5_1_7 }}
rule_1_5_1_8: {{ rule_1_5_1_8 }}

# Crypto Policies
rule_1_6_1: {{ rule_1_6_1 }}
rule_1_6_2: {{ rule_1_6_2 }}
rule_1_6_3: {{ rule_1_6_3 }}
rule_1_6_4: {{ rule_1_6_4 }}

# MOTD and messages
rule_1_7_1: {{ rule_1_7_1 }}
rule_1_7_2: {{ rule_1_7_2 }}
rule_1_7_3: {{ rule_1_7_3 }}
rule_1_7_4: {{ rule_1_7_4 }}
rule_1_7_5: {{ rule_1_7_5 }}
rule_1_7_6: {{ rule_1_7_6 }}

# Gnome desktop
rule_1_8_1: {{ rule_1_8_1 }}
rule_1_8_2: {{ rule_1_8_2 }}
rule_1_8_3: {{ rule_1_8_3 }}
rule_1_8_4: {{ rule_1_8_4 }}
rule_1_8_5: {{ rule_1_8_5 }}
rule_1_8_6: {{ rule_1_8_6 }}
rule_1_8_7: {{ rule_1_8_7 }}
rule_1_8_8: {{ rule_1_8_8 }}
rule_1_8_9: {{ rule_1_8_9 }}
rule_1_8_10: {{ rule_1_8_10 }}

# Section 2 rules
# time sync
rule_2_1_1: {{ rule_2_1_1 }}
rule_2_1_2: {{ rule_2_1_2 }}
rule_2_1_3: {{ rule_2_1_3 }}

# Server services
rule_2_2_1: {{ rule_2_2_1 }}
rule_2_2_2: {{ rule_2_2_2 }}
rule_2_2_3: {{ rule_2_2_3 }}
rule_2_2_4: {{ rule_2_2_4 }}
rule_2_2_5: {{ rule_2_2_5 }}
rule_2_2_6: {{ rule_2_2_6 }}
rule_2_2_7: {{ rule_2_2_7 }}
rule_2_2_8: {{ rule_2_2_8 }}
rule_2_2_9: {{ rule_2_2_9 }}
rule_2_2_10: {{ rule_2_2_10 }}
rule_2_2_11: {{ rule_2_2_11 }}
rule_2_2_12: {{ rule_2_2_12 }}
rule_2_2_13: {{ rule_2_2_13 }}
rule_2_2_14: {{ rule_2_2_14 }}
rule_2_2_15: {{ rule_2_2_15 }}
rule_2_2_16: {{ rule_2_2_16 }}
rule_2_2_17: {{ rule_2_2_17 }}
rule_2_2_18: {{ rule_2_2_18 }}
rule_2_2_19: {{ rule_2_2_19 }}
rule_2_2_20: {{ rule_2_2_20 }}
rule_2_2_21: {{ rule_2_2_21 }}
rule_2_2_22: {{ rule_2_2_22 }}

# Client services
rule_2_3_1: {{ rule_2_3_1 }}
rule_2_3_2: {{ rule_2_3_2 }}
rule_2_3_3: {{ rule_2_3_3 }}
rule_2_3_4: {{ rule_2_3_4 }}
rule_2_3_5: {{ rule_2_3_5 }}

# Section 3 rules
# network connectivity wifi/bluetooth/ipv6
rule_3_1_1: {{ rule_3_1_1 }}
rule_3_1_2: {{ rule_3_1_2 }}
rule_3_1_3: {{ rule_3_1_3 }}

# Network Kernel module
rule_3_2_1: {{ rule_3_2_1 }}
rule_3_2_2: {{ rule_3_2_2 }}
rule_3_2_3: {{ rule_3_2_3 }}
rule_3_2_4: {{ rule_3_2_4 }}

# Network Kernel Params
rule_3_3_1: {{ rule_3_3_1 }}
rule_3_3_2: {{ rule_3_3_2 }}
rule_3_3_3: {{ rule_3_3_3 }}
rule_3_3_4: {{ rule_3_3_4 }}
rule_3_3_5: {{ rule_3_3_5 }}
rule_3_3_6: {{ rule_3_3_6 }}
rule_3_3_7: {{ rule_3_3_7 }}
rule_3_3_8: {{ rule_3_3_8 }}
rule_3_3_9: {{ rule_3_3_9 }}
rule_3_3_10: {{ rule_3_3_10 }}
rule_3_3_11: {{ rule_3_3_11 }}

# Firewall
rule_3_4_1_1: {{ rule_3_4_1_1 }}
rule_3_4_1_2: {{ rule_3_4_1_2 }}

# Firewall rules
rule_3_4_2_1: {{ rule_3_4_2_1 }}
rule_3_4_2_2: {{ rule_3_4_2_2 }}
rule_3_4_2_3: {{ rule_3_4_2_3 }}
rule_3_4_2_4: {{ rule_3_4_2_4 }}
rule_3_4_2_5: {{ rule_3_4_2_5 }}

##
## Section 4 rules
##
# cron
rule_4_1_1_1: {{ rule_4_1_1_1 }}
rule_4_1_1_2: {{ rule_4_1_1_2 }}
rule_4_1_1_3: {{ rule_4_1_1_3 }}
rule_4_1_1_4: {{ rule_4_1_1_4 }}
rule_4_1_1_5: {{ rule_4_1_1_5 }}
rule_4_1_1_6: {{ rule_4_1_1_6 }}
rule_4_1_1_7: {{ rule_4_1_1_7 }}
rule_4_1_1_8: {{ rule_4_1_1_8 }}

# at
rule_4_1_2_1: {{ rule_4_1_2_1 }}

# sshd
rule_4_2_1: {{ rule_4_2_1 }}
rule_4_2_2: {{ rule_4_2_2 }}
rule_4_2_3: {{ rule_4_2_3 }}
rule_4_2_4: {{ rule_4_2_4 }}
rule_4_2_5: {{ rule_4_2_5 }}
rule_4_2_6: {{ rule_4_2_6 }}
rule_4_2_7: {{ rule_4_2_7 }}
rule_4_2_8: {{ rule_4_2_8 }}
rule_4_2_9: {{ rule_4_2_9 }}
rule_4_2_10: {{ rule_4_2_10 }}
rule_4_2_12: {{ rule_4_2_12 }}
rule_4_2_11: {{ rule_4_2_11 }}
rule_4_2_13: {{ rule_4_2_13 }}
rule_4_2_14: {{ rule_4_2_14 }}
rule_4_2_15: {{ rule_4_2_15 }}
rule_4_2_16: {{ rule_4_2_16 }}
rule_4_2_17: {{ rule_4_2_17 }}
rule_4_2_18: {{ rule_4_2_18 }}
rule_4_2_19: {{ rule_4_2_19 }}
rule_4_2_20: {{ rule_4_2_20 }}
rule_4_2_21: {{ rule_4_2_21 }}
rule_4_2_22: {{ rule_4_2_22 }}

# sudo
rule_4_3_1: {{ rule_4_3_1 }}
rule_4_3_2: {{ rule_4_3_2 }}
rule_4_3_3: {{ rule_4_3_3 }}
rule_4_3_4: {{ rule_4_3_4 }}
rule_4_3_5: {{ rule_4_3_5 }}
rule_4_3_6: {{ rule_4_3_6 }}
rule_4_3_7: {{ rule_4_3_7 }}

# Pam software pkgs
rule_4_4_1_1: {{ rule_4_4_1_1 }}
rule_4_4_1_2: {{ rule_4_4_1_2 }}

# authselect
rule_4_4_2_1: {{ rule_4_4_2_1 }}
rule_4_4_2_2: {{ rule_4_4_2_2 }}
rule_4_4_2_3: {{ rule_4_4_2_3 }}
rule_4_4_2_4: {{ rule_4_4_2_4 }}
rule_4_4_2_5: {{ rule_4_4_2_5 }}

# pam faillock
rule_4_4_3_1_1: {{ rule_4_4_3_1_1 }}
rule_4_4_3_1_2: {{ rule_4_4_3_1_2 }}
rule_4_4_3_1_3: {{ rule_4_4_3_1_3 }}

# pam pwquality
rule_4_4_3_2_1: {{ rule_4_4_3_2_1 }}
rule_4_4_3_2_2: {{ rule_4_4_3_2_2 }}
rule_4_4_3_2_3: {{ rule_4_4_3_2_3 }}
rule_4_4_3_2_4: {{ rule_4_4_3_2_4 }}
rule_4_4_3_2_5: {{ rule_4_4_3_2_5 }}
rule_4_4_3_2_6: {{ rule_4_4_3_2_6 }}
rule_4_4_3_2_7: {{ rule_4_4_3_2_7 }}

# pam pwhistory
rule_4_4_3_3_1: {{ rule_4_4_3_3_1 }}
rule_4_4_3_3_2: {{ rule_4_4_3_3_2 }}
rule_4_4_3_3_3: {{ rule_4_4_3_3_3 }}

# pam pam_unix
rule_4_4_3_4_1: {{ rule_4_4_3_4_1 }}
rule_4_4_3_4_2: {{ rule_4_4_3_4_2 }}
rule_4_4_3_4_3: {{ rule_4_4_3_4_3 }}
rule_4_4_3_4_4: {{ rule_4_4_3_4_4 }}

# Shadow user settings
rule_4_5_1_1: {{ rule_4_5_1_1 }}
rule_4_5_1_2: {{ rule_4_5_1_2 }}
rule_4_5_1_3: {{ rule_4_5_1_3 }}
rule_4_5_1_4: {{ rule_4_5_1_4 }}
rule_4_5_1_5: {{ rule_4_5_1_5 }}

# root and sys accts and env
rule_4_5_2_1: {{ rule_4_5_2_1 }}
rule_4_5_2_2: {{ rule_4_5_2_2 }}
rule_4_5_2_3: {{ rule_4_5_2_3 }}
rule_4_5_2_4: {{ rule_4_5_2_4 }}
rule_4_5_2_5: {{ rule_4_5_2_5 }}

# User environment
rule_4_5_3_1: {{ rule_4_5_3_1 }}
rule_4_5_3_2: {{ rule_4_5_3_2 }}
rule_4_5_3_3: {{ rule_4_5_3_3 }}

##
## Section 5 rules
##

# Rsyslog
rule_5_1_1_1: {{ rule_5_1_1_1 }}
rule_5_1_1_2: {{ rule_5_1_1_2 }}
rule_5_1_1_3: {{ rule_5_1_1_3 }}
rule_5_1_1_4: {{ rule_5_1_1_4 }}
rule_5_1_1_5: {{ rule_5_1_1_5 }}
rule_5_1_1_6: {{ rule_5_1_1_6 }}
rule_5_1_1_7: {{ rule_5_1_1_7 }}

# Journald
rule_5_1_2_1_1: {{ rule_5_1_2_1_1 }}
rule_5_1_2_1_2: {{ rule_5_1_2_1_2 }}
rule_5_1_2_1_3: {{ rule_5_1_2_1_3 }}
rule_5_1_2_1_4: {{ rule_5_1_2_1_4 }}
rule_5_1_2_2: {{ rule_5_1_2_2 }}
rule_5_1_2_3: {{ rule_5_1_2_3 }}
rule_5_1_2_4: {{ rule_5_1_2_4 }}
rule_5_1_2_5: {{ rule_5_1_2_5 }}
rule_5_1_2_6: {{ rule_5_1_2_6 }}
rule_5_1_3: {{ rule_5_1_3 }}
rule_5_1_4: {{ rule_5_1_4 }}

# Auditd
rule_5_2_1_1: {{ rule_5_2_1_1 }}
rule_5_2_1_2: {{ rule_5_2_1_2 }}
rule_5_2_1_3: {{ rule_5_2_1_3 }}
rule_5_2_1_4: {{ rule_5_2_1_4 }}
rule_5_2_2_1: {{ rule_5_2_2_1 }}
rule_5_2_2_2: {{ rule_5_2_2_2 }}
rule_5_2_2_3: {{ rule_5_2_2_3 }}
rule_5_2_2_4: {{ rule_5_2_2_4 }}

# auditd rules
rule_5_2_3_1: {{ rule_5_2_3_1 }}
rule_5_2_3_2: {{ rule_5_2_3_2 }}
rule_5_2_3_3: {{ rule_5_2_3_3 }}
rule_5_2_3_4: {{ rule_5_2_3_4 }}
rule_5_2_3_5: {{ rule_5_2_3_5 }}
rule_5_2_3_6: {{ rule_5_2_3_6 }}
rule_5_2_3_7: {{ rule_5_2_3_7 }}
rule_5_2_3_8: {{ rule_5_2_3_8 }}
rule_5_2_3_9: {{ rule_5_2_3_9 }}
rule_5_2_3_10: {{ rule_5_2_3_10 }}
rule_5_2_3_11: {{ rule_5_2_3_11 }}
rule_5_2_3_12: {{ rule_5_2_3_12 }}
rule_5_2_3_13: {{ rule_5_2_3_13 }}
rule_5_2_3_14: {{ rule_5_2_3_14 }}
rule_5_2_3_15: {{ rule_5_2_3_15 }}
rule_5_2_3_16: {{ rule_5_2_3_16 }}
rule_5_2_3_17: {{ rule_5_2_3_17 }}
rule_5_2_3_18: {{ rule_5_2_3_18 }}
rule_5_2_3_19: {{ rule_5_2_3_19 }}
rule_5_2_3_20: {{ rule_5_2_3_20 }}
rule_5_2_3_21: {{ rule_5_2_3_21 }}

# auditd log perms
rule_5_2_4_1: {{ rule_5_2_4_1 }}
rule_5_2_4_2: {{ rule_5_2_4_2 }}
rule_5_2_4_3: {{ rule_5_2_4_3 }}
rule_5_2_4_4: {{ rule_5_2_4_4 }}
rule_5_2_4_5: {{ rule_5_2_4_5 }}
rule_5_2_4_6: {{ rule_5_2_4_6 }}
rule_5_2_4_7: {{ rule_5_2_4_7 }}
rule_5_2_4_8: {{ rule_5_2_4_8 }}
rule_5_2_4_9: {{ rule_5_2_4_9 }}
rule_5_2_4_10: {{ rule_5_2_4_10 }}

# AIDE

rule_5_3_1: {{ rule_5_3_1 }}
rule_5_3_2: {{ rule_5_3_2 }}
rule_5_3_3: {{ rule_5_3_3 }}

##
## Section 6 rules
##

# System file perms
rule_6_1_1: {{ rule_6_1_1 }}
rule_6_1_2: {{ rule_6_1_2 }}
rule_6_1_3: {{ rule_6_1_3 }}
rule_6_1_4: {{ rule_6_1_4 }}
rule_6_1_5: {{ rule_6_1_5 }}
rule_6_1_6: {{ rule_6_1_6 }}
rule_6_1_7: {{ rule_6_1_7 }}
rule_6_1_8: {{ rule_6_1_8 }}
rule_6_1_9: {{ rule_6_1_9 }}
rule_6_1_10: {{ rule_6_1_10 }}
rule_6_1_11: {{ rule_6_1_11 }}
rule_6_1_12: {{ rule_6_1_12 }}
rule_6_1_13: {{ rule_6_1_13 }}
rule_6_1_14: {{ rule_6_1_14 }}

# local and usergroup
rule_6_2_1: {{ rule_6_2_1 }}
rule_6_2_2: {{ rule_6_2_2 }}
rule_6_2_3: {{ rule_6_2_3 }}
rule_6_2_4: {{ rule_6_2_4 }}
rule_6_2_5: {{ rule_6_2_5 }}
rule_6_2_6: {{ rule_6_2_6 }}
rule_6_2_7: {{ rule_6_2_7 }}
rule_6_2_8: {{ rule_6_2_8 }}
rule_6_2_9: {{ rule_6_2_9 }}
rule_6_2_10: {{ rule_6_2_10 }}
rule_6_2_11: {{ rule_6_2_11 }}

##
## Section 1 vars
##
# 1.1.2.2
# 1.1.2.3
# 1.1.2.4
# These settings go into the /etc/fstab file for the /tmp mount settings
# The value must contain nosuid,nodev,noexec to conform to CIS standards
# tmp_tmpfs_settings: "defaults,rw,nosuid,nodev,noexec,relatime 0 0"
# If set true uses the tmp.mount service else using fstab configuration
tmp_svc: {{ tmp_svc }}

# 1.2 patch system
apply_installed_kernel_limit: {{ apply_installed_kernel_limit }}
installed_kernel_limit: {{ installed_kernel_limit }}

# 1.3 Bootloader password
bootloader_password_hash: {{ bootloader_password_hash }}
bootloader_password: {{ bootloader_password }}
set_boot_pass: {{ set_boot_pass }}
boot_path: {{ boot_path }}

# 1.5 SELinux policy
selinux_pol: {{ selinux_policy }}

# 1.6 Set crypto policy (LEGACY, DEFAULT, FUTURE, FIPS)
crypto_policy: {{ crypto_policy }}
# Added module to be allowed as default setting (Allowed options in vars/main.yml)
crypto_policy_module: {{ crypto_policy_module }}

# 1.7
# Warning Banner Content (issue, issue.net, motd)
warning_banner: {{ warning_banner }}
# End Banner

# 1.8 Gnome Desktop
# Whether or not to run tasks related to auditing/patching the desktop environment
gui: {{ gui }}
dconf_db_name: {{ dconf_db_name }}
screensaver_idle_delay: {{ screensaver_idle_delay }}  # Set max value for idle-delay in seconds (between 1 and 900)
screensaver_lock_delay: {{ screensaver_lock_delay }}  # Set max value for lock-delay in seconds (between 0 and 5)
##
## Section 2 vars
##
# 2.1.1 Time Synchronization - Either chrony or ntp
time_synchronization: {{ time_synchronization }}

# Time Synchronization servers - used in template file chrony.conf.j2
time_synchronization_servers:
{% for server in time_synchronization_servers %}
    - {{ server }}
{% endfor %}

chrony_server_options: "{{ chrony_server_options }}"
ntp_server_options: "{{ ntp_server_options }}"

# Service configuration
# Options are
# true to leave installed if exists not changes take place
# false - this removes the package
# mask - if a dependency for product so cannot be removed
# Server Services
autofs_services: {{ autofs_services }}
autofs_mask: {{ autofs_mask }}
avahi_server: {{ avahi_server }}
avahi_mask: {{ avahi_mask }}
dhcp_server: {{ dhcp_server }}
dhcp_mask: {{ dhcp_mask }}
dns_server: {{ dns_server }}
dns_mask: {{ dns_mask }}
dnsmasq_server: {{ dnsmasq_server }}
dnsmasq_mask: {{ dnsmasq_mask }}
samba_server: {{ samba_server }}
samba_mask: {{ samba_mask }}
ftp_server: {{ ftp_server }}
ftp_mask: {{ ftp_mask }}
message_server: {{ message_server }}  # This is for messaging dovecot and cyrus-imap
message_mask: {{ message_mask }}
nfs_server: {{ nfs_server }}
nfs_mask: {{ nfs_mask }}
nis_server: {{ nis_server }}  # set to mask if nis client required
nis_mask: {{ nis_mask }}
print_server: {{ print_server }}  # replaces cups
print_mask: {{ print_mask }}
rpc_server: {{ rpc_server }}
rpc_mask: {{ rpc_mask }}
rsync_server: {{ rsync_server }}
rsync_mask: {{ rsync_mask }}
net_snmp_server: {{ net_snmp_server }}
net_snmp_mask: {{ net_snmp_mask }}
telnet_server: {{ telnet_server }}
telnet_mask: {{ telnet_mask }}
tftp_server: {{ tftp_server }}
tftp_mask: {{ tftp_mask }}
squid_server: {{ squid_server }}
squid_mask: {{ squid_mask }}
httpd_server: {{ httpd_server }}
httpd_mask: {{ httpd_mask }}
nginx_server: {{ nginx_server }}
nginx_mask: {{ nginx_mask }}
xinetd_server: {{ xinetd_server }}
xinetd_mask: {{ xinetd_mask }}
xwindow_server: {{ xwindow_server }}  # will remove mask not an option
is_mail_server: {{ is_mail_server }}

# Client Services
ftp_client: {{ ftp_client }}
openldap_clients_required: {{ openldap_clients_required }}
ypbind_required: {{ ypbind_required }}  # Same package as NIS server
telnet_required: {{ telnet_required }}
tftp_client: {{ tftp_client }}

##
## Section 3 vars
##

bluetooth_service: {{ bluetooth_service }}
bluetooth_mask: {{ bluetooth_mask }}

# System network parameters (host only OR host and router)
is_router: {{ is_router }}

# IPv6 required
ipv6_required: {{ ipv6_required }}

ipv6_sysctl_force: {{ ipv6_sysctl_force }}

##  Optional - Understand the impact of making the following two control to true
# By default, we do not disable IPv6 on localhost, as it's important for multiple
# components.  If you want to disable it anyway, change the following
# value to true refer https://access.redhat.com/solutions/8709
# this changes sysctl and /etc/hosts
# requires reboot
ipv6_disable_localhost: {{ ipv6_disable_localhost }}
# disable ipv6 for sshd
ipv6_sshd_disable: {{ ipv6_sshd_disable }}
# disable chrony on ipv6
ipv6_chrony_disable: {{ ipv6_chrony_disable }}

# Set to 'true' if X Windows is needed in your environment
xwindows_required: {{ xwindows_required }}

## Section3 vars

# default location for the sysctl overrides.
sysctl_file: {{ sysctl_file }}

# Firewall Service - either firewalld or nftables
firewall: {{ firewall }}

default_zone: {{ default_zone }}

nft_tables_autonewtable: {{ nft_tables_autonewtable }}
nft_tables_tablename: {{ nft_tables_tablename }}

# 3.4.2.6 Set nftables new chain create
nft_tables_autochaincreate: {{ nft_tables_autochaincreate }}

#######
## Section4 vars
######
## If using the allow/deny user groups options
sshd_limited: {{ sshd_limited }}
sshd:
    clientalivecountmax: {{ sshd_clientalivecountmax }}
    clientaliveinterval: {{ sshd_clientaliveinterval }}
    logingracetime: {{ sshd_logingracetime }}
    loglevel: {{ sshd_loglevel }}
    macs: '{{ sshd_macs }}'
    maxauthtries: {{ sshd_maxauthtries }}
    maxsessions: {{ sshd_maxsessions }}
    maxstartups: '{{ sshd_maxstartups }}'
    ciphers: '{{ sshd_ciphers }}'
    kex: '{{ sshd_kex }}'
{% if sshd_limited %}
    # WARNING: make sure you understand the precedence when working with these values!!
    {% if sshd_allowusers is defined %}
    # allowusers: '{{ sshd_allowusers }}'
    {% endif %}
    {% if sshd_allowgroups is defined %}
    # allowgroups: '{{ sshd_allowgroups }}'
    {% endif %}
    {% if sshd_denyusers is defined %}
    # denyusers: '{{ sshd.denyusers }}'
    {% endif %}
    {% if sshd_denygroups is defined %}
    # denygroups: '{{ sshd_denygroups }}'
    {% endif %}
{% endif %}

# 4.3. sudo
sudolog_location: "{{ sudolog_location }}"
sudo_timestamp_timeout: {{ sudo_timestamp_timeout }}

## PAM
# 4.4.2.x
allow_authselect_updates: {{ allow_authselect_updates }}
authselect_custom_profile_name: '{{ authselect_custom_profile_name }}'

pam_faillock:
    attempts: {{ pam_faillock_attempts }}
    deny: {{ pam_faillock_deny }}
    interval: {{ pam_faillock_interval }}
    unlock_time: {{ pam_faillock_unlock_time }}
    root_unlock_time: {{ pam_faillock_root_unlock_time }}
    # Choose options below for root options
    root_option: {{ pam_faillock_root_option }}

pam_pwquality:
    difok: {{ pam_pwquality_difok }}
    maxrepeat: {{ pam_pwquality_maxrepeat }}
    maxseq: {{ pam_pwquality_maxseq }}
    minlen: {{ pam_pwquality_minlen }}
    minclass: {{ pam_pwquality_minclass }}

pam_pwhistory:
    remember: {{ pam_pwhistory_remember }}

pam_pwhash: {{ pam_pwhash }}

pass:
    inactive: {{ pam_pass_inactive }}
    max_days: {{ pam_pass_max_days }}
    min_days: {{ pam_pass_min_days }}
    warn_age: {{ pam_pass_warn_age }}

root_umask: {{ root_umask }}  # 0027 or more restrictive

shell_session_timeout:
    file: {{ shell_session_file }}
    timeout: {{ shell_session_timeout }}

# 5.3.7
sugroup: {{ sugroup }}

# wheel users list
sugroup_users: "{{ sugroup_users }}"

inactivelock:
    lock_days: {{ inactivelock.lock_days }}

# 5.6.1.5 Allow ansible to expire password for account with a last changed date in the future. False will just display users in violation, true will expire those users passwords
futurepwchgdate_autofix: {{ futurepwchgdate_autofix }}

## Section5 vars

## Preferred method of logging
## Whether rsyslog or journald preferred method for local logging
syslog: {{ syslog }}
rsyslog_ansiblemanaged: {{ rsyslog_ansiblemanaged }}
# Set if system is the log server
system_is_log_server: {{ system_is_log_server }}

#### remote and destination log server name
remote_log_server: {{ remote_log_server }}
remote_log_host: {{ remote_log_host }}
remote_log_port: {{ remote_log_port }}
remote_log_protocol: {{ remote_log_protocol }}
remote_log_retrycount: {{ remote_log_retrycount }}
remote_log_queuesize: {{ remote_log_queuesize }}

update_audit_template: {{ update_audit_template }}

auditd:
    disk_error_action: {{ auditd_disk_error_action }}
    disk_full_action: {{ auditd_disk_full_action }}
    action_mail_acct: {{ auditd_action_mail_acct }}
    space_left_action: {{ auditd_space_left_action }}
    admin_space_left_action: {{ auditd_admin_space_left_action }}
    max_log_file_action: {{ auditd_max_log_file_action }}

logrotate: {{ logrotate }}

## Journald
# journal_upload_url is the ip address to upload the journal entries to
journal_upload_url: {{ journal_upload_url }}
# The paths below have the default paths/files, but allow user to create custom paths/filenames
journal_upload_serverkeyfile: {{ journal_upload_serverkeyfile }}
journal_servercertificatefile: {{ journal_servercertificatefile }}
journal_trustedcertificatefile: {{ journal_trustedcertificatefile }}

# The variables below related to journald, please set these to your site specific values
# journald_systemmaxuse is the max amount of disk space the logs will use
journald_systemmaxuse: {{ journald_systemmaxuse }}
# journald_systemkeepfree is the amount of disk space to keep free
journald_systemkeepfree: {{ journald_systemkeepfree }}
journald_runtimemaxuse: {{ journald_runtimemaxuse }}
journald_runtimekeepfree: {{ journald_runtimekeepfree }}
# journald_MaxFileSec is how long in time to keep log files. Values are Xm, Xh, Xday, Xweek, Xmonth, Xyear, for example 2week is two weeks
journald_maxfilesec: {{ journald_maxfilesec }}

# logrotate configuration
# change to true if you wish to change logrotate.d conf files
allow_logrotate_conf_umask_updates: {{ allow_logrotate_conf_umask_updates }}

## AIDE
aide_scan: {{ aide_scan }}
config_aide: {{ config_aide }}
# AIDE cron settings
aide_cron:
    cron_user: '{{ aide_cron_user }}'
    cron_file: '{{ aide_cron_file }}'
    aide_job: '{{ aide_cron_job }}'
    aide_minute: '{{ aide_cron_minute }}'
    aide_hour: '{{ aide_cron_hour }}'
    aide_day: '{{ aide_cron_day }}'
    aide_month: '{{ aide_cron_month }}'
    aide_weekday: '{{ aide_cron_weekday }}'

## Section6 vars
